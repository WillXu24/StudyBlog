- 本文介绍以Next为代表的几个优秀主题的配置经历
  - Next
  - indigo
  - Material X

<!--more-->

# 一、前言
- Hexo静态博客本地配置中有两个重要的配置文件，分别是
    - 位于根目录下的`站点配置文件`：/_config.yml
    - 位于根目录/theme/你的主题下的`主题配置文件`：/theme/你的主题/_config.yml
- 两者的关系为前者优先于后者

# 二、主题基础配置

## 1. 极简风主题Next

![](https://i.loli.net/2018/12/30/5c28916b3f17d.png)

### next特点

- 原生简约
- 内置四种风格的站点版式，一个主题顶四个233
- 自定义性强，内置功能多
- 使用人数众多，网上配置教程数不胜数

### 安装
- hexo 默认主题为landscape，新主题需要我们自己下载
- 最简单的是通过git（也可以去官网下载源码）
  ``` bash
  $ git clone https://github.com/theme-next/hexo-theme-next themes/next
  ```

### 切换主题
- 通过更改`站点配置文件`进行主题选择。
  ```yml
  # Extensions
  ## Plugins: https://hexo.io/plugins/
  ## Themes: https://hexo.io/themes/
  theme: next
  ```

### 语言选择
- 该主题默认语言为英语，按照需要进行语言切换
- 找到 `\themes\next\languages` 下支持的文件列表。（例如汉化的zh-CN）
- 再对 `站点配置文件` 进行修改，找到关键词`language`并在后面做修改并保存退出
  ```yml
  # Site 站点配置
  title:                # 网站标题
  subtitle:             # 副标题
  description:          # 网站描述
  keywords:             # 关键字
  author:               # 你的昵称
  language: zh-CN       # 网站语言
  timezone:             # 时区
  ```
- 大部分的博客教程都是将language改为zh-hans，但是主题文件更新后该名称已经失效，望注意！

### 主题模板更换
- next主题提供了四种风格的主题模板，可以自由切换，
至于四种模板的不同，请移步[官方GitHub文档](https://github.com/theme-next/hexo-theme-next)
- 在`主题配置文件` 中查找关键字`Schemes`
- 想要保留的模板前去掉`#`即可。
  ```yml
  # Schemes
  #scheme: Muse（默认主题）
  scheme: Mist
  #scheme: Pisces
  #scheme: Gemini
  ```

### 目录自选
- 在`主题配置文件`中查找关键字`menu`
- 寻找想要的目录并去掉前面的`#`
  ```yml
  menu:
    home: / || home
    #about: /about/ || user
    #tags: /tags/ || tags
    #categories: /categories/ || th
    archives: /archives/ || archive
    #schedule: /schedule/ || calendar
    #sitemap: /sitemap.xml || sitemap
    #commonweal: /404/ || heartbeat
  ```

### 在每篇文章末尾添加 "本文结束"
- 在路径` \themes\next\layout\_macro `中新建 `passage-end-tag.swig `文件,并添加以下内容：
  ```html
  <div>
      {% if not is_index %}
          <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
      {% endif %}
  </div>
  ```
- 接着打开`\themes\next\layout\_macro\post.swig`文件， 查找`post-footer `并在该 div 之前添加如下代码
  ```html
  <div>
    {% if not is_index %}
      {% include 'passage-end-tag.swig' %}
    {% endif %}
  </div>
  ```
- 在`\theme\_config.yml`末尾添加以下代码
  ```yml
  # 文章末尾添加“本文结束”标记
  passage_end_tag:
    enabled: true
  ```

### 删除网页底部 “由hexo强力驱动、主题版本” 文字
- 打开`\themes\next\layout\_partials\footer.swig`文件,找到并删除以下部分。
  ```
  {% if theme.footer.powered.enable %}
    <div class="powered-by">{#
    #}{{ __('footer.powered', next_url('https://hexo.io', 'Hexo', {class: 'theme-link'})) }}{#
    #}{% if theme.footer.powered.version %} v{{ hexo_env('version') }}{% endif %}{#
  #}</div>
  {% endif %}

  {% if theme.footer.powered.enable and theme.footer.theme.enable %}
    <span class="post-meta-divider">|</span>
  {% endif %}

  {% if theme.footer.theme.enable %}
    <div class="theme-info">{#
    #}{{ __('footer.theme') }} – {{ next_url('https://theme-next.org', 'NexT.' + theme.scheme, {class: 'theme-link'}) }}{#
    #}{% if theme.footer.theme.version %} v{{ version }}{% endif %}{#
  #}</div>
  {% endif %}
  ```

### 在网站底部加上访问量
- 打开`\themes\next\layout\_partials\footer.swig`文件,在第一行前加上以下代码
  ```
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  ```
- 在上一步删除的代码位置添加以下代码：
  ```
    <div class="powered-by">
    <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
      本站访客数:<span id="busuanzi_value_site_uv"></span>
    </span>
    </div>
  ```

### 新建标签页面
- 在根目录下进行
  ```
  $ hexo new page tags
  ```

![](https://i.loli.net/2018/12/30/5c28917889dc8.png)

- 对生成的md文件进行编辑,系统将自动识别为标签页面

  ``` 
  title: 标签
  date: 2018-11-28 17:53:24
  type: "tags"
  ---
  ```
  
- 修改`主题配置文件`，添加tags至menu中
  ``` yml
  menu:
    home: / || home
    #about: /about/ || user
    tags: /tags/ || tags
    #categories: /categories/ || th
    archives: /archives/ || archive
    #schedule: /schedule/ || calendar
    #sitemap: /sitemap.xml || sitemap
    #commonweal: /404/ || heartbeat
  ```
- 如果有集成评论服务，页面也会带有评论。 若需要关闭的话，请添加字段 comments 并将值设置为 false
  ```
  title: 标签
  date: 2018-11-28 17:53:24
  type: "tags"
  comments: false
  ```

### 设置头像
-  编辑`主题配置文件`，修改字段 `avatar`，值设置成头像的链接地址。其中，头像的链接地址可以是：
  - 完整的互联网URI:	http://example.com/avatar.png
  - 站点内的地址:放置在`主题文件夹`的 source/images/ 目录下 配置为：avatar: /images/avatar.png
    ``` yml
      # Sidebar Avatar 头像
      avatar:
        # in theme directory(source/images): /images/avatar.gif
        # in site  directory(source/uploads): /uploads/avatar.gif
        # You can also use other linking images.
        url:  #/images/avatar.gif
        # If true, the avatar would be dispalyed in circle.
        rounded: false
        # The value of opacity should be choose from 0 to 1 to set the opacity of the avatar.
        opacity: 1
        # If true, the avatar would be rotated with the cursor.
        rotated: false
    ```

### 设置网页标签页左侧标记
- 编辑`主题配置文件`，修改字段 `favicon`，文件放在`主题文件夹`的`相对地址`
  ```yml
    # For example, you put your favicons into `hexo-site/source/images` directory.
    # Then need to rename & redefine they on any other names, otherwise icons from Next will rewrite your custom icons in Hexo.
    favicon:
      small: /images/favicon-16x16-next.png
      medium: /images/favicon-32x32-next.png
      apple_touch_icon: /images/apple-touch-icon-next.png
      safari_pinned_tab: /images/logo.svg
      #android_manifest: /images/manifest.json
      #ms_browserconfig: /images/browserconfig.xml
  ```
- 效果图

![](https://i.loli.net/2018/12/30/5c289197347eb.png)

## 2. Material Design主题indigo

![](https://i.loli.net/2018/12/30/5c289232a3e19.png)

### indigo特点

- Material Design风格爱好者不要错过
- 本身默认开启了许多有用的功能
  - 赞赏
  - 默认头像
  - rss
  - 站内搜索
  - 分享
  - 等等。。
- 懒癌患者，不想配置或者配置主题到自闭的博主福音。（大佬请无视）

### 安装

- 通过git（也可以去官网下载源码）

  ```bash
  $ git clone https://github.com/yscoder/hexo-theme-indigo themes/indigo
  //或者
  // $ git clone git@github.com:yscoder/hexo-theme-indigo.git themes/indigo
  ```

### 依赖安装

- Less：主题默认使用 less 作为 css 预处理工具。

  ```bash
  $ npm install hexo-renderer-less --save
  ```

- Feed：用于生成 rss。(可选)

  ```bash
  $ npm install hexo-generator-feed --save
  ```

- Json-content：用于生成静态站点数据，用作站内搜索的数据源。

  ```bash
  $ npm install hexo-generator-json-content --save
  ```

- QRCode：用于生成微信分享二维码。（可选，不安装时会请求 jiathis Api 生成二维码。）

  ```bash
  $ npm install hexo-helper-qrcode --save
  ```

### 切换主题

- 通过更改`站点配置文件`进行主题选择。

  ```yml
  # Extensions
  ## Plugins: https://hexo.io/plugins/
  ## Themes: https://hexo.io/themes/
  theme: indigo
  ```

## 3. 简约卡片式主题Material X

![](https://ws1.sinaimg.cn/large/0063gtC1gy1fzhp8uu4f2j31o0140tps.jpg)

### Material X特点

- 使用卡片设计元素以及交互动效。
- 高度可定制化的侧边栏小部件。
- 使用 [fontawesome 5.6.3](https://fontawesome.com/icons?d=gallery&m=free) 免费版图标。
- 支持MobShare分享，自定义分享按钮的icon、图片。
- 支持3种评论系统：Disqus、来必力和Valine评论。（以及基于Valine的 [Volantis](https://xaoxuu.com/wiki/material-x/third-party-services/#Volantis) ）
- 提供主题CDN，也可自定义CDN。
- 方便更换主题色、自定义字体、边距、圆角、阴影等视觉效果。
- 支持APlayer播放器，可以播放网易云、QQ音乐、虾米、酷狗平台以及其它服务器的音乐。
- 针对推荐文章插件进行了布局优化。
- 支持不蒜子阅读统计、百度分析、Google分析。
- 支持渲染MathJax数学公式，优化了渲染效果。
- 针对移动端布局进行了优化。
- 使用 [import](https://xaoxuu.com/wiki/material-x/config/#import) 字段方便导入各种标签到主题中。
- 使用`top: true`置顶你最爱的文章！

### 安装

参考作者[主题文档](https://xaoxuu.com/wiki/material-x/index.html#)

# 三、主题进阶配置（均以next为例）

## 1. 添加极简风评论系统Valine

### 注册账号

- 在[LeanCloud官网](https://leancloud.cn/dashboard/login.html#/signup)进行账号注册。
  ![](https://i.loli.net/2018/12/30/5c28924425ead.png)

### 创建应用并获取Leancloud Key

- 点击创建应用，取名任意，其余设置默认即可。
- 点击设置-应用key，可以看到 App ID 和 App Key
- 保留页面，待会有用。
  ![](https://i.loli.net/2018/12/30/5c28924f6eafd.png)

### 修改主题配置文件

- 为了保险起见，推荐你先备份下 `/themes/next/_config.yml`。以防出现不备。

- 在`/themes/next/_config.yml`中查找关键词`valine`完善代码如下

  ```yml
  # Valine.
  # You can get your appid and appkey from https://leancloud.cn
  # more info please open https://valine.js.org
  valine:
    enable: true # 功能开关
    appid: **************** # 你的 appid
    appkey: *************** # 你的 appkey
    notify: false # 新评论的邮件通知
    verify: false # 评论是否需要验证码
    placeholder: 说点什么 # 评论框提示语
    avatar: hide # 游客头像
    guest_info: nick,mail,link # 游客信息
    pageSize: 10 # 分页数量
    visitor: false # leancloud-counter-security is not supported for now. When visitor is set to be true, appid and appkey are recommended to be the same as leancloud_visitors' for counter compatibility. Article reading statistic https://valine.js.org/visitor.html
  
  ```

### 添加安全域名

- Leancloud -> 设置 -> 安全中心 -> Web 安全域名 ，把你的域名加进去
  ![](https://i.loli.net/2018/12/30/5c289259e2303.png)

### 参考文档

- [Valine -- 一款极简的评论系统](https://ioliu.cn/2017/add-valine-comments-to-your-blog/)
- [Valine - 一款快速、简洁且高效的无后端评论系统。](https://valine.js.org/)

## 2. 添加每篇文章的计数

### 注册并创建应用

- 如图（我创建过的所以有请求记录）
  ![](https://i.loli.net/2018/12/30/5c289296d8d1f.png)

### 点击 储存-创建Class

- 名字必须必须必须为`Counter`！！
- 无限制写入
- 最后点击创建
  ![](https://i.loli.net/2018/12/30/5c2892a4a4525.png)

### 修改主题配置文件

- 点击设置-应用Key 记录appid与appkey

- 填写到`主题配置文件`的对应位置

- 记得将security项改为false！！

  ```yml
      # Show number of visitors to each article.
      # You can visit https://leancloud.cn get AppID and AppKey.
      leancloud_visitors:
      enable: true
      app_id: 填写 #<app_id>
      app_key: 填写 #<app_key>
      # Dependencies: https://github.com/theme-next/hexo-leancloud-counter-security
      # If you don't care about security in lc counter and just want to use it directly
      # (without hexo-leancloud-counter-security plugin), set the `security` to `false`.
      security: false
      betterPerformance: false
  ```

## 3. 页面切换时的动态标签页效果 

在\themes\next\source\js\src目录下新建dytitle.js。添加以下内容:

```js
<!--动态标题-->
var OriginTitile = document.title;
var titleTime;
document.addEventListener('visibilitychange', function () {
    if (document.hidden) {
        $('[rel="icon"]').attr('href', "/img/TEP.ico");
        document.title = ' 哦豁，崩溃啦！';
        clearTimeout(titleTime);
    }
    else {
        $('[rel="icon"]').attr('href', "/favicon.ico");
        document.title = ' 诶，又好了！ ';
        titleTime = setTimeout(function () {
            document.title = OriginTitile;
        }, 2000);
    }
});
```

ps：注意一下以上代码中图标的路径名称更换。

## 4. 自动更换背景

更改\themes\next\layout\_layout.swig。在</body>之前添加：

```
<!--动态标题-->
<script type="text/javascript" src="/js/src/dytitle.js"></script>
```

修改themes\next\source\css\_custom\custom.styl文件

```
// 网页背景
body {

    background:url(https://source.unsplash.com/random/1600x900); //括号内网站可自行更换为喜欢的图片

    background-repeat: no-repeat;

    background-attachment:fixed;

    background-position:50% 50%;

}

// 文章内容块
.main-inner { 

    background: #fff;

	opacity: 0.91; //内容块的透明度

}
```

# 四、以上的步骤结束后需要进行部署

- 根目录下执行(第二步本地预览可选)
  ```
  $ hexo clean //消除大部分的缓存引起的更新未显示问题
  $ //hexo s
  $ hexo g -d //hexo generate + hexo deploy
  ```

